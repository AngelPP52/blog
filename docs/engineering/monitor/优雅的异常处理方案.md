> 参考原文：https://juejin.im/post/6844903709323837454#heading-0

# 客户端

## 代码执行错误

### try...catch

捕获代码执行的错误，但无法捕获到语法的错误

### window.onerror

参数：

- `msg` - 错误发生的异常信息（字符串）
- `url` - 错误发生的脚本URL（字符串）
- `lineNum` - 错误发生的行号（数字）
- `colNum` - 错误发生的列号（数字）
- `err` - 错误发生的Error对象（错误对象）

> 可以捕获throw但没catch的错误。**不能捕获promise的错误**

### window.addEventListener('unhandledrejection')

捕获那些不能被try...catch和window.onerror捕获的错误，比如promise的错误。_兼容性一般_

```js
window.addEventListener('unhandledrejection', (e) => {
    console.log(`Promise.reject()中的内容，告诉你发生错误的原因:${e.reason}`);
  	console.log(`Promise对象 :${e.promise}`);
})
```

### window.addEventListener('error',function,boolean)

> 可以监听到资源加载报错，也可以注册多个事件处理函数
>
> 在大多数情况下addEventListener('error')和window.onerror的效果差不多。在浏览器中有两种事件机制，捕获和冒泡，这两个方法就分别是通过捕获和冒泡来拿到error的
>
> 然而window.onerror无法拿到资源加载错误

```js
// 这段代码必须运行在所有资源加载之前
window.addEventListener('error', (errorEvent) => {
    console.log(errorEvent)
    cosnole.log(errorEvent.message) // 如果有message字段，说明就是资源加载错误
}, true)
```

## 资源加载错误

### onerror

> 捕获静态资源的错误
>
> 对代码的侵入性比较强，不是很好~

```js
<script src="https://cdn.xxx.com/js/test.js"  onerror="errorHandler(this)"></script>

<link rel="stylesheet" href="https://cdn.xxx.com/styles/test.css" onerror="errorHandler(this)">
```

### performance.getEntries()

> 获取成功加载的资源

### imgObj.onerror()

> 图片不存在的时候就会触发onerror事件

### window.addEventListener('error, (msg,url,row,col,error)=>{},true)

> 会捕获但不会冒泡
>
> 可以捕捉网络请求的异常，但是无法判断HTTP的状态是404还是其他比如500，还得配合服务端日志进行排查分析

### Script error

1. 在script标签中加上crossorigin属性，告诉服务器自己的来源，再决定是否返回
2. 响应头加`Access-Control-Allow-Origin`来支持跨域

## 打印错误信息

### console.error

用来**打印错误日志**的。那些可预知，已经被捕获的错误，已经被处理过的内容。